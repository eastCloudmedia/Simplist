<?php

namespace Controller\Panel;


use Model\Repository\MainFunction\PostRepository;
use Model\Repository\MainFunction\UrlRepository;
use Model\Repository\MainFunction\UserRepository;
use Route\Show\View;

class AdminController
{
    private $Post;
    private $User;
    private $Url;
    public function __construct()
    {
        $this->Post= new PostRepository();
        $this->User= new UserRepository();
        $this->Url= new UrlRepository();
    }

    public function Index()
    {
        $Viewbag=['UserInfo'=>$this->User->FindByUser($_COOKIE['Username'])['Values'],];
        View::Process("Panel.Admin.Panel",$Viewbag);
    }

    public function Users()
    {
        View::Process("Panel.Admin.Users");
    }

    public function NewPost()
    {
        View::Process("Panel.Admin.NewPost");
    }
    public function Post()
    {
        View::Process("Panel.Admin.Posts");
    }
    public function PostDelete($QuerryString)
    {

        $Querry= substr($QuerryString,29);

        if ($this->Post->GetPostById($Querry)['Rows']==1)
        {
            $Viewbag = ['PostInfo'=>$this->Post->GetPostById($Querry)['Values']];
            View::Process("Panel.Admin.PostDelete",$Viewbag);
        }
        else
        {
            View::Process("Helper.Home.Error404");
        }    }
    public function PostUpdate($QuerryString)
    {
        $Querry= substr($QuerryString,29);

        if ($this->Post->GetPostById($Querry)['Rows']==1)
        {
            $Viewbag = ['PostInfo'=>$this->Post->GetPostById($Querry)['Values']];
            View::Process("Panel.Admin.PostUpdate",$Viewbag);
        }
        else
        {
            View::Process("Helper.Home.Error404");
        }
    }

    public function NewUrl()
    {
        View::Process("Panel.Admin.NewUrl");
    }
    public function Url()
    {
        View::Process("Panel.Admin.Url");
    }
    public function UrlDelete($QuerryString)
    {
        $Id= substr($QuerryString,27);

        if ($this->Url->FindById($Id)['Rows']==1)
        {
            $Viewbag = ['UrlInfo'=>$this->Url->FindById($Id)['Values']];
            View::Process("Panel.Admin.UrlDelete",$Viewbag);
        }
        else
        {
            View::Process("Helper.Home.Error404");
        }
    }
    public function UrlUpdate($QuerryString)
    {
		$Id = substr($QuerryString,27);

        if ($this->Url->FindById($Id)['Rows']==1)
        {
            $Viewbag = ['UrlInfo'=>$this->Url->FindById($Id)['Values']];
            View::Process("Panel.Admin.UrlUpdate",$Viewbag);
        }
        else
        {
            View::Process("Helper.Home.Error404");
        }
    }
}