<?php

namespace Controller\Panel;


use Model\Repository\MainFunction\PostRepository;
use Model\Repository\MainFunction\UserRepository;
use Route\Show\View;

class AdminController
{
    private $Post;
    private $User;
    public function __construct()
    {
        $this->Post= new PostRepository();
        $this->User= new UserRepository();
    }

    public function Index()
    {
        $Viewbag=['UserInfo'=>$this->User->FindByUser($_COOKIE['Username'])['Values'],];
        View::Process("Panel.Admin.Panel",$Viewbag);
    }
    public function NewPost()
    {
        View::Process("Panel.Admin.NewPost");
    }
    public function Users()
    {
        View::Process("Panel.Admin.Users");
    }
    public function Post()
    {
        View::Process("Panel.Admin.Posts");
    }
    public function PostDelete($QuerryString)
    {

        $Querry= substr($QuerryString,29);

        if ($this->Post->GetPostById($Querry)['Rows']==1)
        {
            $Viewbag = ['PostInfo'=>$this->Post->GetPostById($Querry)['Values']];
            View::Process("Panel.Admin.PostDelete",$Viewbag);
        }
        else
        {
            View::Process("Helper.Home.Error404");
        }    }
    public function PostUpdate($QuerryString)
    {
        $Querry= substr($QuerryString,29);

        if ($this->Post->GetPostById($Querry)['Rows']==1)
        {
            $Viewbag = ['PostInfo'=>$this->Post->GetPostById($Querry)['Values']];
            View::Process("Panel.Admin.PostUpdate",$Viewbag);
        }
        else
        {
            View::Process("Helper.Home.Error404");
        }
    }
}